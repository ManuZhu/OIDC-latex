\section{Threat Model and Assumption}
\label{sec:assumptionandthreatmodel}
There are three types of entities in UPRESSO, i.e., the IdP, a group of RPs and users.
Unlike existing privacy-preserving SSOs \cite{xx}, UPRESSO does not rely on any trusted third parties.
% 有其他可以比较吗？


\subsection{Threat Model}
While the IdP is assumed to be semi-honest, the users and RPs can be malicious or even collude with each other. However, even with the presence of malicious RPs and users in the login flows, UPRESSO is expected to protect honest users from (1) being impersonated by the malicious user to log in to the honest RPs, and (2) logging in to the honest RPs as the malicious user.
%The group users are consisted of parts of malicious users and other honest users, and similarly there are also malicious and honest RPs. It must be ensured to protect the honest users from,
In particular, the adversary attempts to break the security and privacy properties under the following threat model.

\vspace{1mm}\noindent \textbf{Honest but Curious IdP.}
%All the actions performed by IdP fulfil the requirements of UPRESSO and none of action undefined is conducted.
%But the IdP might try to achieve the additional information which is not defined to be exposed to IdP passively without breaking the rule of UPRESSO.
We assume the IdP is well-protected and its private key for signing the RP certificate and identity proof is never leaked. The IdP always processes messages correctly and never colludes with other malicious entities. More specifically, for RP's initial registration, the IdP checks the correctness of RP's URL,  assigns an unique original identifier, and generates the correct signature. For identity proof, the IdP generates the proof only for the authenticated user, calculates the user identifier based on the user's unique identifier
and the user-provided transformation of RP identifier, binds the proof with the transformation, generates the signature correctly, and sends it only to the user. Moreover, the IdP never colludes with malicious RP nor user.

However, the IdP is also curious about users' private information. It may attempt to infer the user's access traces (i.e., which RPs accessed by the user) by analyzing the content and timing of the received messages. %For example, inferring RP's identifiers in (or receivers of) the identity proof.
%But IdP will never collude with RPs.

\vspace{1mm}\noindent \textbf{Malicious User.} %The user might be under the full control of adversaries, so that the malicious user is able to conduct any action defined or not defined in the UPRESSO.
The adversary may obtain the user's credential through various attacks, or register a valid account at the IdP and the RPs.
The user controlled by the adversary may behave arbitrarily, attempting to perform the impersonation attacks and identity injection.
For example, the malicious user  may send illegal login request to the RP,
transmit a modified or forged identity proof request to the IdP,
reply a corrupted or forged identity proof to the RP, or choose a non-random nonce to participate in the generation of RP's transformation identifier.
%to login at a RP under a uncontrolled user's account,

\vspace{1mm}\noindent \textbf{Malicious RP.} %The RP might be corrupted by the adversary or just built by the adversary, which is able to perform any action desired by the adversary for any purpose.
The adversary may work as a RP itself, by controlling one or multiple compromised RPs, or registering as valid RPs with the IdP.
The malicious RPs may behave arbitrarily to break the integrity, confidentiality and binding of the identity proof.
For example, they may manipulate the generation of identity proofs by deliberately choosing certain nonces in RP identifier transformations and trick honest RPs to accept them,
provide an incorrect identity proof request with incorrect RP identifiers,
or send the invalid or other RP's valid certificate instead of its own. %Moreover, the RPs will never collude with the IdP.

%Moreover, the conclusion is also considered available in UPRESSO, of which the details are shown as follows:
%The malicious users and RPs may collude as follows:

\vspace{1mm}\noindent \textbf{Colluded RPs and users.} The malicious users and RPs may collude to perform the impersonation or identity injection attacks.
For example, %to log in to the honest RP under the victim user's account,
the adversary may first attract the victim user to access a malicious RP to initiate an authentication request for identity proof that is also valid to honest RPs, and then pretend to be the victim user to access these RPs using the received identity proof. %To make the victim user log in to the honest RP under an malicious account,
The adversary may also act as a user to obtain an identity proof for herself to access an honest RP, and then work as an RP to redirect the victim user to the honest RP using her proof (e.g. CSRF).

\vspace{1mm}\noindent \textbf{Colluded RPs.} To break user's privacy, the colluding RPs may link user accounts across them by actively returning incorrect messages, or passively combining the received messages.
%using the same (or derivable) user identifier in the identity proof.
However, user linkage based on other attributes in user accounts and the global network traffic analysis are not considered in this work, which may be prevented by limiting the attributes exposed to each RP and introducing cover traffic by accessing irrelevant RPs.

\subsection{Assumptions}
In UPRESSO, we assume the user agent deployed at the honest user is correct,
and will transmit the messages to the correct destination without leakage.
The TLS is correctly implemented at the user agent, IdP and RP, which ensures the confidentiality and integrity of the network traffic between correct entities.
We also assume the random numbers in UPRESSO are unpredictable by using  a secure random number generator;
and the adopted cryptographic algorithms, including the RSA and SHA-256 required in UPRESSO, are secure and implemented correctly, that is, no one without private key can forge the signature,
and the adversary fails to infer the private key.
Moreover, according to the Discrete Logarithm Problem,
we assume the adversary fails to infer $r$ from $g^r mod\ p$, where $p$ is a large prime and $g$ is the primitive root, which is required by the the transformation of the RP's identifier and trapdoor identification.

\begin{comment}
\subsection{Assumptions}
In UPRESSO, we assume the user agent deployed at the honest user is correct,
and will transmit the messages to the correct destination without leakage.
The TLS is correctly implemented at the user agent, IdP and RP, which ensures the confidentiality and integrity of the network traffic between correct entities.
We also assume the nonce is unpredictable by using  a secure random number generator;
and the adopted cryptographic algorithms, including the RSA and SHA-256 for the RP certificate, are secure and implemented correctly, that is, no one without the IdP's private key can produce a valid certificate,
and the adversary fails to infer the private key.
Moreover, the transformation of the RP's identifier and the user's account calculation are based on the Discrete Logarithm Problem,
we assume the adversary fails to infer $r$ from $g^r mod\ p$, where $p$ is a large prime and $g$ is the primitive root.
%However, although IdPs are interested in the user's login trace, IdP will never collude with RPs.
\end{comment}







\begin{comment}
In addition to the conventional processes (described in Section~\ref{subsec:OIDC}) as in the typical SSO systems~\cite{SAMLIdentifier,OpenIDConnect}, extra processes are required on the entities in UPRESSO to include the solutions provided in section~\ref{subsec:solutions}:
\begin{itemize}
  \item IdP. In the initial registration of RP,  IdP checks the correctness of RP's URL,  assigns an unique original identifier, and generates the RP certificate with its private key. For each identity proof request, IdP calculates the PPID based on the provided RP's transformation identifier.
  \item User. The user verifies the received RP certificate, generates a nonce to participate in the generation of RP's transformation identifier with the RP's original identifier extracted from the certificate, sends the transformation to the IdP, and relays the identity proof to the URL extracted from the RP certificate.
  \item RP. The RP applies the RP certificate from the IdP with correct URL, provides it to the user on each login request, generates a nonce to participate in the generation of RP's transformation identifier, calculates the trapdoor of the transformation, and uses it to derive the user's unique account.
\end{itemize}


\noindent\textbf{Assumption.} In UPRESSO, we assume the user agent deployed at the honest user is correct, and will transmit the messages to the correct destination without leakage. The TLS is correctly implemented at the user agent, IdP and RP, which ensures the confidentiality and integrity of the network traffic between correct entities. We also assume the nonce is unpredictable by using  a secure random number generator; and the adopted cryptographic algorithms, including the RSA and SHA-256 for the RP certificate, are secure and implemented correctly, that is, no one without the IdP's private key can produce a valid certificate, and the adversary fails to infer the private key. Moreover, the transformation of the RP's identifier and the user's account calculation are based on the Discrete Logarithm Problem, we assumes the adversary fails to infer $r$ from $g^r mod P$, where $P$ is a large prime and $g$ is the primitive root.


\subsection{Threat Model}
\label{subsec:threatmodel}
In UPRESSO, the adversary attempts to break the security and user's privacy under the following threat model.

\noindent\textbf{Security.} The adversary attempts to break the confidentiality, integrity or binding of the identity proof, for impersonating the victim user to access a RP, or making the user access a RP under an incorrect account. Same as traditional SSO systems~\cite{SAMLIdentifier,OpenIDConnect,persona,SPRESSO}, we assume the IdP is honest, uncorrupted users and RPs behave correctly, while the user and RP controlled by the adversary may be malicious. The details are as follows:


\textbf{Honest but Curious IdP.} The IdP is well protected and the private keys for signing the RP certificate and identity proof are not leaked. In the initial registration of RP,  IdP checks the correctness of RP's URL,  assigns an unique original identifier, and generates the correct signature. For identity proof, IdP generates the proof only for the authenticated user, calculates the PPID based on the user's unique identifier and the user-provided transformation of RP identifer, binds the proof with the transformation, generates the signature correctly, and sends it only to the user.

\textbf{Malicious User.} The adversary may obtain the user's credential through various attacks, or register a valid account at the IdP and RP. The user controlled by the adversary may behave arbitrarily. For example, to login at a RP under a uncontrolled user's account, the adversary may send illegal login request to the RP, transmit a modified or forged identity proof request to the IdP, reply a corrupted or forged identity proof to the RP,  choose a non-random nonce to participate in the generation of RP's transformation identifier.

\textbf{Malicious RP.} The adversary may work as RPs and behave arbitrarily, by controlling one or more compromised RPs, or registering as multiple valid RPs at the IdP. The malicious RP may attempt to make the identity proof bound with it be  accepted by other RPs, by using one or more chosen nonce for the RP's transformation identifiers; or receive an identity proof bound with other RP, by sending another valid or invalid RP certificate instead of its own one, or providing an incorrect identity proof request.

\subsection{Assumption}


\textbf{Collusion.} The malicious users and RPs may collude to perform the impersonation attack and identity injection. For example, (1) to login at the uncorrupted RP under the uncontrolled user's account, the adversary firstly attracts the uncontrolled user to access the malicious RP, then attempts to make the identity proof also valid for the uncorrupted RP, and finally pretends as a user to access this RP with the received identity proof; (2) To make the uncontrolled user login at the uncorrupted RP under an controlled account, the adversary acts as a user to obtain an identity proof for itself by accessing the uncorrupted RP, and works as a RP to redirect the uncontrolled user to the uncorrupted RP with this proof (e.g. CSRF).


\noindent\textbf{Privacy.} The curious IdP may attempt to infer the user's access traces (i.e., which RPs are accessed by one user), by analyzing the content and timing of received messages, for example, inferring RP's identifiers in (or the receivers of) the identity proof. The colluded (malicious) RPs may link the accounts in each RP actively (providing incorrect messages) and passively (combining the received messages),  using the same (or derivable) PPID in the identity proof. Same as SPRESSO~\cite{SPRESSO}, we assume that IdP will never collude with RPs; the user linkage based on other attributes and the global network traffic analysis are not considered in this work, which may be prevented by limiting the attributes exposed to each RPs and proving the mixed traffic by accessing unwanted RPs.


In SSO systems, IdP has the max authority in this system. Therefore, IdP should be considered honest but curious. Otherwise, an malicious IdP has the ability to log in to any RP as any honest user (impersonation attack) and enforce any honest user to log in honest RP under an adversary's identity (identity injection). Moreover, a user's login trace is never hidden from collusion between IdP and RP. It is considered that any RP could be corrupted and any user may be the adversary. User agent is considered completely honest but under control of the user. Therefore, the user agent is seemed as a part of user. Moreover, as network flows are protected by various ways, such as TLS, the network attacker is not considered. The ability of each entity acted by adversary are shown as follows:
\begin{itemize}
\item \textbf{Curious IdP} acts as an completely honest IdP.
\item \textbf{Malicious RP} has the ability to build any response, as well as the authentication request, for user's requestion.
\item \textbf{Malicious User} is able to intercept and tamper all the data transmitted through itself.
%\item \textbf{Network Attacker} has the ability to listen all the IP address on the Internet but unable to tamper any the network flows as they are protected by various ways, such as TLS.
\end{itemize}

To explicitly illustrate how an adversary works in the SSO system, the \verb+authentication flow+ is created to defined the authentication of specific IdP,  RP and user. For example, now there are $IdP$, $User_{A}$, $User_{B}$, $RP_{A}$ and $RP_{B}$, who are able to form 4 \verb+authentication flow+s, ($IdP$, $User_{A}$, $RP_{A}$), ($IdP$, $User_{A}$, $RP_{B}$), ($IdP$, $User_{B}$, $RP_{A}$) and ($IdP$, $User_{B}$, $RP_{B}$). An adversary has the ability to act one or more entities in single or multiple \verb+authentication flow+s. That is, an adversary is able to act as, i) the single entity in one \verb+authentication flow+, such as the curious IdP; ii) the same entity in multiple \verb+authentication flow+s, such as acting as different RPs for the same honest user ; iii) the different entities in multiple \verb+authentication flow+s, such as acting as the RP for the honest user and the user for the honest RP at the same time. However, it is considered an adversary should not act as both the IdP and RP in single \verb+authentication flow+.

%However, Identity Injection only occurs when 1) IdP is dishonest; 2) the transmission between RP and IdP is corrupted by either corrupted user agent or unprotected network flows. Therefore, Identity Injection is not considered.
\end{comment}
