\section{Related Works}%各个方向全都加入，例如安全分析
\label{sec:related}
%SSO was first proposed in **.
Kerberos~\cite{Kerberos}, SAML, OAuth, OIDC and CAS\cite{aubry2004esup}, typical SSO standards, have been adopted and implemented by Google, Facebook, Twitter, etc.
%In 2014, Chen et al.\cite{ChenPCTKT14} concludes the problems developers may face to in using sso protocol. It describes the requirements for authentication and authorization and different between them. They illustrate what kind of protocol is appropriate to authentication. And in this work the importance of secure base for token transmission is also pointed.
%The NIST SP800-63C~\cite{NIST2017draft} issues the security and privacy considerations about SSO systems. And the supplementary standards of widely deployed SSO~\cite{rfc6819} systems also indicate the key points of authentication, where the importance of secure base for token transmission is also pointed.
However, various attacks were proposed for the impersonation attack and identity injection, by breaking the confidentiality, integrity and binding of identity proof. 
%Extensive efforts have been devoted to the security considerations of SSO systems. 
In 2012, Juraj et al.\cite{SomorovskyMSKJ12} found XSW vulnerabilities which allows attackers insert malicious elements in 11 SAML frameworks and Wang et al.~\cite{WangCW12} proposed the traffic-guided analysis of SSO systems and found out several flaws in different systems. In 2014 Zhou et al.~\cite{ZhouE14}, in 2016 Wang et al.~\cite{WangZLG16} and Yang et al.~\cite{YangLLZH16} built the automatic tester to analyse the implementations of existing applications and achieve the statistical result of these applications. Moreover, the malicious IdP is also considered, where in 2018 the Mohammad et al.~\cite{GhasemisharifRC18} demonstrates the vulnerabilities and protect of IdP account hijack, which is the single failure in SSO systems and in 2016 and 2017 Christian et al.~\cite{MainkaMS16, MainkaMSW17} proposed the corrupted IdP might compromise the account associated with other IdPs. Besides, other analysis about SSO systems in various directions, such as in 2013 Armando et al.~\cite{ArmandoCCCPS13} issued the specific code injection in Google SSO system results in the impersonate attack, in 2014 Cao et al.~\cite{CaoSBKVC14} discussed about the security of communication channel between the RP and the IdP and in 2018 Yang et al.~\cite{YangLCZ18} analysed the SDK implementation of OAuth 2.0.


%Besides of OAuth 2.0 and OpenID Connect 1.0, Juraj et al.\cite{SomorovskyMSKJ12} find XSW vulnerabilities which allows attackers insert malicious elements in 11 SAML frameworks. It allows adversaries to compromise the integrity of SAML and causes different types of attack in each frameworks.

\textbf{The SSO is also adopted in the mobile application}, for example, Google, Facebook and other IdPs have already provided the mobile SSO service. \textbf{However, new attacks were found,} as the mobile applications fails to ensure the confidentiality, integrity and binding. In 2014 Chen et al.~\cite{ChenPCTKT14} generally demonstrated the difference between authentication and authorization and the challenges introduced by the migration of SSO systems from website to mobile application and in 2016 Mohsen et al.~\cite{MohsenS16} proposed the security of SSO systems implemented through WebView, one of the most important Android components.
 Moreover, in 2016 Wang et al.~\cite{WangZLG16} analysed the design and implementation of SSO systems for multiple platforms with the automatic testing. In 2015 Wnag et al.~\cite{WangZLLYLG15}, in 2017 Yang et al.~\cite{YangLS17} and in 2019 Shi et al.~\cite{ShiWL19} issued the new vulnerabilities in mobile SSO systems and conducted security assessments for the top Android applications and and achieve the statistical result of these applications.




\textbf{The comprehensive formal security Analysis were performed on SAML, OAuth and OIDC.} Firstly in 2008 Armando et al.~\cite{ArmandoCCCT08} built the formal model of the protocol implemented in the SAML-based Google SSO system and revealed the flaws. In 2016 and 2017 Fett et al.~\cite{FettKS16, FettKS17} conducted the formal analysis of the OAuth 2.0 and OpenID Connect standards using an expressive Dolev-Yao style model, and found the flaws in the implementation of SSO systems. Finally, it is proved that OAuth 2.0 and OpenID Connect satisfies the authorization and authentication requirements with the fixes. Besides, in 2015 Ye et al.~\cite{YeBWD15} performed a formal analysis on the implementation of Android SSO systems and identified a major vulnerability in the existing Facebook Login implementation on Android system.

%In 2016, Daniel et al.\cite{FettKS16} conduct comprehensive formal security Analysis of OAuth 2.0. In this work, they illustrate attacks on OAuth 2.0 and OpenID Connect. Besides they also presents the snalysis of OAuth 2.0 about authorization and authentication properties and so on. Other security analysis\cite{WangCW12}\cite{ZhouE14}\cite{WangZLG16}\cite{YangLLZH16}\cite{WangZLLYLG15} on SSO system concludes the rules SSO protocol must obey with different manners.


\textbf{As suggested in NIST SP800-63C~\cite{NIST2017draft}, user's privacy should be protected in SSO systems, which is partially achieved in the SSO standards, BrowerID and SPRESSO.}
The user's privacy protection~\cite{NIST2017draft} in SSO systems includes, 1) the user should be able to control the range of the attributes exposed to the RP, 2) multiple RPs should fail to link the user through collusion, 3) IdP should fail to obtain the trace of RPs accessed by a user and employ technical measures, such as the use of pairwise pseudonymous to prevent the user linkage among multiple RPs.
In 2014 Chen et al.~\cite{ChenPCTKT14} and in 2016 Yang et al.~\cite{YangLLZH16} illustrated the security and privacy consideration so OAuth 2.0 system about notification which immigrates the first 2 privacy issues. Similarly, the guideline of OIDC~\cite{OpenIDConnect} requires the End-User consent for the release of the user's information.
The guidelines of OIDC~\cite{OpenIDConnect} and SAML~\cite{SAML} suggests that the IdP should provide the pairwise user identifier.
However, the widely deployed SSO systems are all unable to prevent the IdP from tracing the user. To achieve the goal of protecting user from being tracked by IdP, in 2013 Mozilla proposed the Persona~\cite{persona} based on the BrowserID protocol~\cite{BrowserID}, which is now migrated to Firefox Accounts~\cite{FirefoxAccount}. BrowserID enables the RP to identify the user through the login request signed by user's private key and the key is bound with user's email by IdP who need not know the  RP's identity. In 2014 and 2015, Fett et al.~\cite{FettKS14, BrowserID} performed the formal analysis on the BrowserID and finally found the flaw in it. In 2015 Fett et al.~\cite{SPRESSO} proposed SPRESSO, the privacy-preserving SSO system, which enables the IdP to issue the identity proof for the encrypted RP identifier which does not expose RP's identity. However, no existing SSO systems protect user's login trace from both IdP tracking and RPs linking the user.

%The first property is satisfied in most SSO systems. For example, in OAuth, OIDC and SAML, IdP exhibits the attributes requested by the RP and sends the attributes to the RP only when the user has provided a clear consent, which may also minimize the exposed attributes as the user may disagree to provide partial attributes.
%BrowserID\cite{BrowserID}\cite{FettKS14} is a user privacy respecting SSO system proposed by Molliza. BrowserID allows user to generates asymmetric key pair and upload its public to IdP. IdP put user's email and public key together and generates its signature as user certificate (UC). User signs origin of the RP with its private key as identity assertion (IA). A pair containing a UC and a matching IA is called a certificate assertion pair (CAP) and RP authenticates a user by its CAP. But UC contains user's email so that RPs are able to link a user's logins in different RPs.
%SPRESSO\cite{SPRESSO} allows RP to encrypt its identity and a random number with symmetric algorithm as a tag to present itself in each login. And token containing user's email and tag signed by IdP is also encrypted by a symmetric key provided by RP. During parameters transmission a third party credible website is required to forward important data. As token contains user's email, RPs are able to link a user's logins in different RPs.


\textbf{Anonymous SSO scheme is proposed to hide the user's identity to both the IdP and RPs, which can only be applied to the services that do not need the user's unique identifier.}
One of the earliest anonymous SSO system is proposed by Elmufti et al.~\cite{ElmuftiWRR08} in 2008 for Global System for Mobile (GSM) communication. In 2013 Wang et al.~\cite{WangWS13} formalized the notion of anonymous single sign-on and proposed the anonymous based on group signatures. Moreover, in 2018 Lee et al.~\cite{Lee18} proposed the anonymous SSO system  based on Chebyshev chaotic-map-based assumptions and in 2018 Han et al.~\cite{HanCSTW18} proposed the system based on zero-knowledge proof. However, as the anonymous SSO system hides the user's identity from both IdP and RP, it is impossible for RP to provide personalize service to specific user.

%Anonymous SSO schemes prevents the IdP from obtaining the user's identity for RPs who do not require the user's identity nor PII, and just need to check whether the user is authorized or not. These anonymous schemes, such as the anonymous scheme proposed by Han et al.~\cite{HanCSTW18}, allow user to obtain a token from IdP by proving that he/she is someone who has registered in the Central Authority based on  Zero-Knowledge Proof. RP is only able to check the validation of the token but unable to identify the user.
%In 2018, Han et al.\cite{HanCSTW18} proposed a novel SSO system which uses zero knowledge to keep user anonymous in the system. A user is able to obtain a ticket for a verifier (RP) from a ticket issuer (IdP) anonymously without informing ticket issuer anything about its identity. Ticket issuer is unable to find out whether two ticket is required by same user or not. The ticket is only validate in the designated verifier. Verifier cannot collude with other verifiers to link a user's service requests. Same as the last work, system verifier is unable to find out the relevance of same user's different requests so that it cannot provide customization service to a user. So this system is not appropriate for current web applications.
%In 2010, Han et al.\cite{HanMSY10} proposed a dynamic SSO system with digital signature to guarantee unforgeability. To protect user's privacy, it uses broadcast encryption to make sure only the designated service providers is able to check the validity of user's credential. User uses zero-knowledge proofs to show it is the owner of the valid credential. But in this system verifier is unable to find out the relevance of same user's different requests so that it cannot provide customization service to a user. So this system is not appropriate for current web applications.
%In 2013, Wang et al. proposed anonymous single sign-on schemes transformed from group signatures. In an ASSO scheme, a user gets credential from a trusted third party (same as IdP) once. Then user is able to authenticate itself to different service providers (same as RP) by generating a user proof via using the same credential. SPs can confirm the validity of each user but should not be able to trace the user’s identity.
