\section{Evaluation}
\label{sec:evaluation}
The prototype system runs on Thinkcentre M8600t with an Intel Core i7-6700 CPU, 500GB SSD and 8GB of RAM running Windows 10.  
\subsection{Implementation} 
%与原系统相比做了哪些改动
Implementation of system contains modification of IdP as well as RP and creation of user agent. User agent runs on chrome 71.0.3578.98 as its extension.  

System's parameters are carefully chosen in specification about \textbf{Difie-Hellman} algorithm. $p$ is one of primes provided by the specification and $a$ is its generator. All the primitive elements module $p$ is generated by $a$. 

Compared with formal openid connect system, the work we do is shown as following:
\begin{itemize}
    \item Modifying RP registration so that IdP is able to offer RP\_cert to RP. 
    \item Providing RP's client\_id negotiation interface.
    \item Providing RP's dynamic registration acceptance interface.
    \item Implementing user-id-generating algorithm at IdP.
    \item Implementing the function of getting user\_rp\_id from user\_id at RP.
    \item Realizing function of client\_id negotiation, dynamic registration, id\_token transmitting and so on at user agent.
\end{itemize}
\subsection{Storage}
As the prime $p$ is 2048-bit-length, storage of client\_id, user\_id and user\_rp\_id are no larger than 512 Bytes as hexadecimal. We consider they are all 512 Bytes in evaluation.

For IdP and RP's user Personally Identifiable Information (PII) storage, it changes from a short user id into a 512 Bytes id. It is assumed that an IdP owns 100 million users and an RP owns 10 million users. If a user's PII costs 500 Bytes extra storage so that IdP need to offer 50 billion Bytes (less than 50 GB) storage and RP need to offer 5 billion Bytes (less than 5 GB) storage. The extra cost of storage can be omitted. 

For IdP's dynamic registration storage, the data contains RP's client\_id and redirect\_uri. We consider that each dynamic registration data cost no more than 550 Bytes storage. And for each client\_id IdP can set the lifetime of validity. It is assumed that for each client\_id its lifetime is 2 minutes and during 2 minutes there are 1 million requests for dynamic registration. So IdP need to offer 550 million Bytes (about 500 MB) storage for dynamic registration. The extra cost of storage can be omitted.

For user's login log stored in RP and IdP, RP and IdP are able to transform PII into a shorter hash characters. So it almost cost no more extra storage. 
\subsection{Timings}
Table~\ref{tab:timeings} shows the result of the time cost in PRISSO's each phases. We log in the prototype 100 times and figure out the average time cost. It can be found that the most of time consumed in client\_id negotiation phase, dynamic registration conducted by user and IdP providing id\_token. They cost 4337ms in average which is more than 90\% of total time. In client\_id negotiation to confirm $r=pk\_rp^y mod p$ is a relative prime of $p-1$ user has to continue generating $y$ until $r$ is validate which costs most of time. In dynamic registration user need check validation of basic\_rp\_id and IdP's URL by rp\_certificate, calculate client\_id by basic\_rp\_id, $r$ and check the result of registration and forward it to RP. In SSO system if user firstly log in an RP it is necessary for user to confirm permission of login in the specific RP. It is showed as user has to press the confirm button in IdP's website. In PRISSO client\_id is random so that every login for a user is first login. So every login requires user to press a button redundantly. Even the press action is conducted by chrome extension, it costs some time.  

We also do login in traditional OpenID-Connect system 100 times and get a total time cost 44ms in average. Compared with traditional system, PRISSO's time cost is about 100 times.
\begin{table}
\caption{Benchmark Result}
\begin{tabular*}{\linewidth}{@{\extracolsep{\fill}}ll}
\toprule
phase& time (ms)\\
\hline
Client\_id Negotiation (RP)& 49\\
Client\_id Negotiation (user)& 2967\\
Dynamic registration (IdP)& 16\\
Dynamic registration (user)& 1001\\
Obtaining Token (IdP)& 369\\
Obtaining Token (RP)& 19\\
Network Cost& 12\\
Total Time& 4433\\
\bottomrule
\label{tab:timeings}
\end{tabular*}
\end{table}
%\subsection{Throughput}

\subsection{Optimizing}
As the most time cost is in client\_id negotiation and dynamic registration and these two phases are transparent to user. To reduce time cost we move client\_id negotiation and dynamic registration to website initiation. When user visit RP's login page user agent conducts client\_id negotiation and dynamic registration during page loading. So for a user its login procedure starts at obtaining token and network time cost is halved. The total time cost is about 406ms and the system possesses practicability.