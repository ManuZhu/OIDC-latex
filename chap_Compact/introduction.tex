\section{Introduction}
\label{sec:intro}
Single sign-on (SSO) protocols such as OpenID Connect (OIDC) \cite{OpenIDConnect}, OAuth 2.0 \cite{rfc6749}, and SAML \cite{SAML, SAMLIdentifier}, are widely deployed for identity management and authentication.
 %With the help of SSO, a user logs in to a website, referred to as the \emph{relying party} (RP), using his account registered at a trusted web service, known as the \emph{identity provider} (IdP).
SSO allows a user to log into a website,
    %%%% other big-4 papers use "login"
    %%%% "login" is a noun, but not a verb
 known as the \emph{relying party} (RP), using her account registered at a trusted web service, known as the \emph{identity provider} (IdP).
An RP delegates user identification and authentication to the IdP, which issues an \emph{identity token} (such as id token in OIDC or identity assertion in SAML) for a user to visit the RP. %after authenticating this user.
For instance, in an OIDC system, the user sends a login request to an RP,
which constructs an identity-token request with its identity (denoted as $ID_{RP}$) and redirects it to a trusted IdP. After authenticating the user, the IdP issues an identity token that binds the identities of both the user and the RP (i.e., $ID_U$ and $ID_{RP}$), which is returned to the user and then forwarded to the RP.
Finally, the RP verifies the identity token to determine if the token holder is authorized to log in. Thus, a user keeps only one credential for the IdP, instead of multiple credentials for different RPs.

SSO services provide a comprehensive solution for identity management and authentication,
 by enabling an IdP to enclose more user attributes in identity tokens, in addition to the authenticated user's identity.
These attributes (e.g., age, hobby, education, and nationality) are maintained at the IdP and can be enclosed in identity tokens with user authorization \cite{OpenIDConnect,rfc6749}.

The wide adoption of SSO raises concerns about user privacy because it facilitates the tracking of a user's login activities by interested parties \cite{NIST2017draft, SPRESSO, BrowserID, maler2008venn}.
To issue identity tokens, %in each login,
 an IdP is aware of the RP which a user is attempting to log into and the time of this login.
Thus, an honest-but-curious IdP could potentially track a user's login activities over time \cite{BrowserID, SPRESSO},
% This data can be further analyzed to profile users' online activities, as in other web tracking attacks.
called {\em IdP-based login tracing} in this paper.
Another privacy risk arises from the fact that RPs learn the user's identity from the identity tokens they receive.
If the same user identity is enclosed in tokens for the visits to different RPs \cite{maler2008venn, Google, FirefoxAccount}, colluding RPs could link these logins across different RPs %and track the user's activities
to learn the user's online profile \cite{maler2008venn}.
This risk is called {\em RP-based identity linkage}.


Privacy-preserving SSO schemes aim to support comprehensive identity management and authentication
 while protecting user privacy \cite{maler2008venn, NIST2017draft, BrowserID, SPRESSO}.
They typically offer the following features:
(\emph{a}) \emph{unique user identification at each RP}, which is provided through SSO identity tokens,
(\emph{b}) \emph{user authentication only to a trusted IdP},
 which eliminates the need for authentication between a user and an RP and requires maintaining only the credential for the IdP,
%only the user's secret credential to authenticate herself to the IdP,
%    different types of credentials are supported in the authentication between the IdP and users,
and (\emph{c}) \emph{provision of IdP-confirmed user attributes},
 where a user's attributes are maintained at a trusted IdP and provided to RPs with the user's authorization.
%It is also important to consider the privacy threats posed by different types of adversaries:
 Meanwhile, the privacy threats posed by different types of adversaries are considered, including \emph{an honest-but-curious IdP}, \emph{colluding RPs}, and \emph{the honest-but-curious IdP colluding with some RPs}.
In Section \ref{subsec-solutions}, we analyze existing privacy-preserving solutions for SSO and also identity federation in light of these privacy threats.


%We propose {\em identity transformations} for privacy-preserving SSO and then present an Untraceable and Unlinkable Privacy-PREserving Single Sign-On (UPPRESSO) protocol. We design identity-transformation algorithms in the SSO login flow. In each login, $ID_{RP}$ is transformed into an ephemeral $PID_{RP}$ by a user and an RP. $PID_{RP}$ is then sent to an IdP to transform $ID_U$ into ephemeral $PID_U$, so an identity token binds $PID_U$ and $PID_{RP}$, instead of permanent $ID_U$ and $ID_{RP}$. Finally, on receiving an identity token with a matching $PID_{RP}$, the RP transforms $PID_U$ into an account. Given a user, this account is identical across multiple logins for an RP but unique at each RP.
This paper presents \usso, an Untraceable and Unlinkable Privacy-PREserving Single Sign-On protocol.
 %for privacy-preserving SSO services. % 注释这几个词，一下子减少不少篇幅
It proposes {\em identity transformations} and integrates them into the SSO login flow.
In \usso, an RP and a user first transform $ID_{RP}$ into an ephemeral identity $PID_{RP}$, which is then sent to a trusted IdP to transform $ID_U$ into an ephemeral user identity $PID_U$.
The identity token issued by the IdP then binds only $PID_U$ and $PID_{RP}$, instead of $ID_U$ and $ID_{RP}$. When the RP receives the identity token with a matching $PID_{RP}$, it transforms $PID_U$ into an account that is unique at each RP but identical across multiple logins to this RP.


%UPPRESSO prevents the IdP-based login tracing as only $PID_{RP}$ is sent in identity-token requests, and the RP-based identity linkage for every user account is unique (see Section \ref{sec:analysis} for details). On the contrary, existing privacy-preserving SSO solutions \cite{BrowserID,SPRESSO,NIST2017draft,FirefoxAccount} prevent only one of these two privacy threats. The identity transformations work compatibly with widely-used SSO protocols \cite{OpenIDConnect,rfc6749,SAML,NIST2017draft}, so the above desirable features of SSO services are well kept in UPPRESSO, while not all these features are supported in privacy-preserving identity federation \cite{PseudoID,ELPASSO,UnlimitID,Opaak,uprov,hyperledge-idemix}.

\usso\ prevents two privacy risks, IdP-based login tracing and RP-based identity linkage, while existing privacy-preserving SSO solutions \cite{BrowserID, SPRESSO, NIST2017draft, FirefoxAccount} address only one of them. Meanwhile, \usso\ is designed to be compatible with widely-used SSO protocols \cite{OpenIDConnect, rfc6749, SAML, NIST2017draft}, ensuring that all of the desirable features of SSO services are supported, and then offers a comprehensive privacy-preserving SSO solution.
In contrast, privacy-preserving identity federation \cite{PseudoID, ELPASSO, UnlimitID, Opaak, uprov, hyperledge-idemix} supports some but not all of these features.

Our contributions are as follows.
\vspace{-\topsep}
\begin{itemize}
\setlength{\topsep}{0pt}
\setlength{\partopsep}{0pt}
\setlength{\itemsep}{0pt}
\setlength{\parsep}{0pt}
\setlength{\parskip}{0pt}
\item We proposed a novel identity-transformation approach for privacy-preserving SSO and also designed identity-transformation algorithms with desirable properties.
\item We developed the \usso\ protocol based on identity transformations with several designs specific to web applications, and proved that it satisfies the security and privacy requirements of SSO services.
\item We implemented a prototype of \usso\ for web applications on top of an open-source OIDC implementation. Through performance evaluations, we confirmed that \usso\ introduces reasonable overheads.
\end{itemize}


%The remainder is organized as below.
We present the background and related works in Section \ref{sec:background} and the identity-transformation approach in Section \ref{sec:challenge}, followed by the detailed designs in Section \ref{sec:UPPRESSO}.
Security and privacy are analyzed in Section \ref{sec:analysis}.
We explain the prototype implementation and evaluations in Section \ref{sec:implementation} and discuss some extended issues in Section \ref{sec:discussion}. Section \ref{sec:conclusion} concludes this work.
