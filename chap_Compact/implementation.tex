\section{Implementation and Performance Evaluation}
\label{sec:implementation}
We have implemented the prototype of UPRESSO, and compared its performance with the original OIDC implementation and SPRESSO.

\subsection{Implementation}
We adopt SHA-256 to generate the digest, and  RSA-2048 for the signature in  the $Cert_{RP}$, identity proof and the dynamic registration response. We  choose a random 2048-bit strong prime as $p$, and the smallest primitive root (3 in the prototype)  of $p$ as $g$. The  $n_U$, $n_{RP}$ and $ID_U$  are 256-bit odd numbers, which provides equivalent security strength than RSA-2048~\cite{barkerecommendation}.

The implementation of IdP only need introduce the minimal modification of existing OIDC implementation. The IdP is implemented based on MITREid Connect~\cite{MITREid}, an open-source OIDC Java implementation certificated by the OpenID Foundation~\cite{OIDF}. 
In UPRESSO, we add 3 lines Java code for generation of $PPID$, 25 lines for generation of signature in dynamic registration, modify 1 line for checking the registration token in dynamic registration, while the calculation of $ID_{RP}$, $Cert_{RP}$,  $PID_U$, and the RSA signature is implemented using the Java built-in cryptographic libraries (e.g., BigInteger)

The user-side processing is implemented as a Chrome extension with about 330 lines JavaScript code and 30 lines  Chrome extension configuration files (specifying the required permissions, containing reading chrome tab information, sending the HTTP request, blocking the received HTTP response). The cryptographic calculation in $Cert_{RP}$ verification, $PID_{RP}$ negotiation, dynamic registration, is based on an efficient JavaScript cryptographic library  jsrsasign~\cite{jsrsasign}. 
Moreover, the chrome extension needs to construct cross-origin requests to communicate with the RP and IdP, which is forbidden by the same-origin security policy as default. Therefore it is required to add the HTTP header \verb+Access-Control-Allow-Origin+ in the response of IdP and RP to accept only the request from the origin \verb+chrome-extension://chrome-id+ (\verb+chrome-id+ is uniquely assigned by the Google).

We provide the SDK for RP to integrate UPRESSO easily. The SDK provides 2 functions: 
processing of the user's login request and  identity proof parsing. The Java SDK is implemented based on the Spring Boot framework  with about 1100 lines JAVA code. The cryptographic computation is completed through Spring Security library.
RP processing login request containing identifier negotiation and renewal in Figure~\ref{fig:process} and identity proof parsing containing account calculating in Figure~\ref{fig:process}.

