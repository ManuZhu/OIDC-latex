\section{Implementation and Evaluation}
\label{sec:implementation}
We implemented the UPPRESSO prototype,\footnote{The prototype is open-sourced at https://github.com/uppresso/.}
 and experimentally compared it
 with two open-source SSO systems:
  (\emph{a}) MITREid Connect \cite{MITREid}
    which supports the PPID-enhanced OIDC protocol to prevent the RP-based identity linkage,
     and (\emph{b}) SPRESSO \cite{SPRESSO} preventing the IdP-based login tracing.

\subsection{Prototype Implementation}
\label{subsec:proto-imple}
The identity transformations are defined on
        the NIST P256 elliptic curve.
RSA-2048 and SHA-256 are used as the signature algorithm and the hash function, respectively.

An IdP is built on top of MITREid Connect \cite{MITREid},
    an open-source OIDC Java implementation, %certificated by the OpenID Foundation \cite{OIDF},
    and only a few modifications are needed.
We add only 3 lines of Java code to calculate $PID_U$,
    and 20 lines to modify the way to send identity tokens.
The calculations of $ID_{RP}$ and $PID_U$ are implemented based on Java cryptographic libraries.

The IdP and RP scripts include about 160 and 140 lines of JavaScript code, respectively.
%to provide the functions in Steps 2.1, 2.3, and 4.3.
The cryptographic computations such as $Cert_{RP}$ verification and $PID_{RP}$ negotiation, are finished based on jsrsasign \cite{jsrsasign}, an efficient JavaScript cryptographic library.
%This chrome extension requires permissions  \emph{chrome.tabs} and \emph{chrome.windows} to obtain the RP's URL from the browser's tab,  and \emph{chrome.webRequest} to intercept, block, modify requests to the IdP or RP \cite{chromeExtension}.


We finished a Java RP SDK.
This SDK provides two functions to encapsulate the protocol steps:
 one to request identity tokens,
    and the other to derive accounts. %from identity tokens.
It is implemented based on the Spring Boot framework  with about 500 lines of Java code,
 and cryptographic computations are done based on the Spring Security library.
An RP invokes these functions for the integration,
    by less than 10 lines of Java code.
