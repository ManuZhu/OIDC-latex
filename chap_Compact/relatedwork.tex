\subsection{Other Related Works of Secure SSOs}
\label{sec:related}

\noindent\textbf{Anonymous SSOs.} Anonymous SSO systems have been formalized~\cite{WangWS13} and proposed for different applications such as GSM communications \cite{ElmuftiWRR08}, distributed networks \cite{WangWS13}, and designated verifiers \cite{HanCSTW18, HanCSTWW20} using different privacy-preserving primitives such as group signature, zero-knowledge proof, and proxy re-verification. These approaches allow users to access services anonymously, preventing verifiers from linking the user's requests. However, they cannot support user identification at the RPs due to the use of anonymous credentials.

%Such tokens (or credentials) authorize a user to conduct operations
%        in privacy-preserving ways.
%
%    tokens (or credentials) authorize a user to conduct operations
%        in privacy-preserving ways.
%Privacy-enhancing technologies have been applied in various scenarios,
%  but not adopted to comprehensively transform the five (pseudo-)identities in SSO services.
\noindent\textbf{Anonymous Tokens.}
\textcolor{blue}{Anonymous tokens such as PrivacyPass and TrustToken \cite{privacypass, trusttoken} have been proposed for applications that need to grant anonymous access to authorized users. In these approaches, the server (such as the IdP) blindly binds user-selected secrets $t_i$ (such as pseudonyms) and access tokens ($T_i, T_i^{k{r_i}}$) and signs them with its secret key $k$, where $T_i=H(t_i)$ and $H$ is a hash function. The user unblinds these tokens to obtain anonymous tokens ($t_i, T_i^k$) and redeem them later on the server. As the token signing and redemption operations are separated and cannot be linked due to blind signing, they can be used to implement anonymous SSO services that are secure against IdP-based tracing and RP-based linkage.
}

\textcolor{blue}{PrivacyPass and TrustToken applied a similar cryptographic technique proposed for oblivious pseudorandom functions (OPRFs) \cite{oprf-proved}, which is also used in UPPRESSO. However, they provide SSO services that are fundamentally different from the ones offered by UPPRESSO. As shown in Table~\ref{tbl:comparison-protocol}, they lack support for all three SSO features. First, the anonymous tokens used by different users or by the same user in different login instances cannot be distinguished (i.e., no user identification at RPs), since they are signed blindly using the same server secret. Besides, the users are required to maintain anonymous tokens for asynchronous authentication in addition to the credentials for the IdP, similar to other privacy-preserving solutions based on anonymous credentials. Finally, PrivacyPass and TrustToken do not support selective user attribution provisioning. In contrast, UPPRESSO formalizes the privacy-preserving SSO process as two ID-transformation problems and generates unlinkable pseudoidentities and proofs to support the desired SSO features. So, it is compatible with widely-adopted SSO protocols.
}

%\textcolor{blue}{PrivacyPass and TrustToken allow a user to receive tokens \cite{privacypass,trusttoken}, each of which is denoted as ($T, T^{k}$), where $k$ is the token server's private key. These tokens are used to access resources anonymously in the future. To unlink token signing and redemption, a user generates a random number $e$ for each token, blinds $T$ into $T^{e}$, and sends it to request ($T^e, T^{ek}$) from the token server. The user then utilizes $e$ to obtain $T^k$ from $T^{ek}$, and then only ($T, T^{k}$) is redeemed to access resources. This cryptographic skill \cite{oprf-proved} is used in UPPRESSO similarly: a user transforms $ID_{RP}$ to $PID_{RP} = [t]ID_{RP}$ by a random number $t$, and $PID_{RP}$ is transformed again by an IdP to $[tu]ID_{RP}$. The visited RP calculates $Acct = [u]ID_{RP}$ from $[tu]ID_{RP}$ by using $t$ (see Table \ref{tbl:notations-protocol} for detailed descriptions of these notations).}

% \textcolor{blue}{UPPRESSO differs from PrivacyPass and TrustToken as below.
% Firstly, PrivacyPass and TrustToken work as anonymous SSO to some extent, where one consistent private key serves all users, but UPPRESSO identifies each user at an RP.
% Secondly,
%    the above cryptographic skill \cite{oprf-proved} is differently utilized.
% UPPRESSO integrates it to transform identities in SSO:
% scalar $u$ is known by the IdP and a user as his user identity, and
% random number $t$ is shared by the user and the RP. Meanwhile,
% exponent $k$ is held only by the PrivacyPass/TrustToken server as a private key,
%  and random number $e$ is only known to a user.
% Lastly and most importantly,
% more privacy requirements are satisfied in UPPRESSO.
% The unlinkability between token signing and redemption \cite{privacypass,trusttoken}, or
% ($T^e, T^{ek}$) and  ($T, T^k$),
% roughly corresponds to only the IdP-untraceability in UPPRESSO:
%  an IdP cannot link any pair among $[t_i]ID_{RP}$ and $ID_{RP}$,
%  $i = 1, 2, \cdots$. % which fundamentally depends on the ECDLP assumption.
% UPPRESSO also supports the unlinkability across RPs:
% given multiple users, e.g., identified as $u$ and $u'$,
%     ($ID_{RP}, t, [u]ID_{RP}$) and ($ID_{RP'}, t', [u']ID_{RP'}$) are indistinguishable to
%     colluding RPs.
% This property of the adopted cryptographic skill is not considered
%     in anonymous tokens \cite{privacypass,trusttoken} or oblivious pseudorandom functions (OPRFs) \cite{oprf-proved}.}

% \noindent\textbf{Anonymous SSO.}
% Such schemes allow authenticated users to access a service protected by an IdP,
%     without revealing their identities.
% Anonymous SSO was proposed for GSM communications \cite{ElmuftiWRR08},
%     and formalized \cite{WangWS13}.
% Privacy-preserving primitives, such as group signature, zero-knowledge proof, Chebyshev Chaotic Maps and proxy re-verification,
%      were adopted to design anonymous SSO \cite{WangWS13,HanCSTW18,Lee18,HanCSTWW20}.
% Anonymous SSO schemes work for some special applications,
%     but are unapplicable in most systems that require user identification for customized services.

\noindent\textbf{Privacy-preserving credential.}
ZKlaims \cite{zklaim} allows users to prove statements on the credentials issued by a server using zero-knowledge proofs without revealing the content of the credentials. 
%Crypto-Book \cite{crypto-book} coordinates servers to generate a ring-signature private key, %and a user picks up his key through a list of Email addresses. % (i.e., an anonymity set).
%which is used by the user as an untraceable pseudonym.  %to sign messages. 
%Two-party threshold cryptographic schemes are implemented with a central server, to protect user private keys \cite{mRSA,ss-rsa}: to sign/decrypt a message, a user needs a token from the server.
Tandem \cite{tandem} generates one-time-use key-share tokens for securing cryptographic keys used on user devices. %and decouples the obtaining and using of such tokens for the privacy of key usage.
Similar to anonymous credentials, they do not support the desired SSO features. 

%\vspace{0.5mm}
% \noindent\textbf{Formal analysis for SSO protocols.}
% %The SSO standards (e.g., SAML, OAuth, and OIDC) have been formally analyzed.
% Fett et al. \cite{FettKS16, FettKS17} formally analyzed OAuth 2.0 and OIDC using a Dolev-Yao-style model \cite{FettKS14} and reported the 307 redirection and IdP mix-up attacks.
% %When the IdP misuses an HTTP 307 status code for redirection, the sensitive information (e.g., credentials) entered at the IdP
%          %   will  be leaked to the RP through  the user's browser.
%         %The IdP mix-up attack confuses the RP about which IdP is used and the victim RP sends the token to a malicious IdP,
%         % which breaks the confidentiality of identity tokens.
% %According to these formal proofs \cite{FettKS16, FettKS17},
% %    OAuth 2.0 and OIDC are secure except these two attacks.
% %UPPRESSO could be integrated into OIDC, which simplifies its security analysis.
% An analysis on SAML-based SSOs \cite{ArmandoCCCT08} found that a Google-implemented variant does not bind the RP identities in the identity tokens correctly.


%\vspace{0.5mm}
\noindent\textbf{Implementation vulnerabilities in SSOs and formal analysis.}
Vulnerabilities have been found in SSO implementations for web applications, resulting in various attacks %of impersonation and identity injection
that break the confidentiality \cite{WangCW12,ccsSunB12,ArmandoCCCPS13,DiscoveringJCS,dimvaLiM16}, integrity \cite{WangCW12,SomorovskyMSKJ12,WangZLG16,MainkaMS16, MainkaMSW17,dimvaLiM16} or RP designation \cite{WangZLG16,MainkaMS16,MainkaMSW17,YangLCZ18,dimvaLiM16} of identity tokens.
%In the SSO services of Google and Facebook, %from the view of browser-relayed traffics
%    logic flaws of the IdPs and RPs were detected \cite{WangCW12}.  % to break the confidentiality and integrity of identity tokens.
The integrity of identity tokens was violated %\cite{SomorovskyMSKJ12,WangCW12,WangZLG16,MainkaMS16, MainkaMSW17}
due to software flaws such as defective verification by RPs \cite{WangCW12,WangZLG16,MainkaMSW17}, XML signature wrapping \cite{SomorovskyMSKJ12}, and IdP spoofing \cite{MainkaMS16,MainkaMSW17}. Meanwhile, the RP designation was broken because of incorrect binding by an IdP \cite{YangLCZ18,WangZLG16} or insufficient verification by RPs \cite{MainkaMS16,MainkaMSW17,YangLCZ18}. Similarly, vulnerabilities have been found in Android Apps that break the confidentiality \cite{ChenPCTKT14,WangZLLYLG15,YangLS17,ShiWL19}, integrity \cite{ChenPCTKT14,YangLS17}, and RP designation \cite{ChenPCTKT14,ShiWL19} of identity tokens. Furthermore, if a user is compromised, the     attacker can log in to RPs on his behalf. So, we consider malicious users, malicious RPs, and colluding users and RPs in our threat model (see Section~\ref{subsec:threatmodel}).

An analysis on SAML-based SSOs \cite{ArmandoCCCT08} found that a Google-implemented variant does not bind the RP identities in the identity tokens correctly. Later, Fett et al.~\cite{FettKS16, FettKS17} formally analyzed OAuth 2.0 and OIDC using a Dolev-Yao-style model \cite{FettKS14} and reported the 307 redirection and IdP mix-up attacks. In this paper, we also adopt a Dolev-Yao-style model to formally prove the security of UPPRESSO (see Section~\ref{adver-model}).



% Automatic tools such as SSOScan \cite{ZhouE14}, OAuthTester \cite{YangLLZH16} and S3KVetter \cite{YangLCZ18},
% detect the violations of confidentiality, integrity, or RP designation of SSO identity tokens.
% Wang et al. \cite{ExplicatingSDK} detect the vulnerable applications
%     built with authentication/authorization SDKs,
%      due to the implicit but unsuitable assumptions of these SDKs.
% Navas et al. \cite{NavasB19} discussed the possible attack patterns against OIDC services.

% In a mobile system,
% browsers, IdP Apps,
%     or IdP-provided SDKs %(e.g., an encapsulated WebView)
%          are responsible for forwarding identity tokens, %from the IdP App to RP Apps.
% but none of them ensures an identity token is sent to the designated RP only \cite{ChenPCTKT14,WangZLLYLG15}.
% %    because a WebView or the system browser cannot authenticate the RP Apps and the IdP App may be repackaged.
% %SSO protocols are modified for mobile Apps, but the modifications are not well understood by developers \cite{ChenPCTKT14,YangLS17}.
% Vulnerabilities were found in Android Apps,
%     to break confidentiality \cite{ChenPCTKT14,WangZLLYLG15,YangLS17,ShiWL19}, integrity \cite{ChenPCTKT14,YangLS17}, and RP designation \cite{ChenPCTKT14,ShiWL19} of identity tokens.
% A flaw was found in Google Apps \cite{ArmandoCCCPS13}, allowing a malicious RP to hijack a user's authentication attempt and inject a payload to steal the cookie or identity token belonging to another RP.

% If a user is compromised,
%     attackers will login to RPs on behalf of him.
% Single sign-off helps the victim user
%  to revoke all his tokens accepted and logout from the RPs  \cite{GhasemisharifRC18}.
% FedCM \cite{FedCM} attempts to disable iframe and third-party cookies in SSO, which might be exploited to track users.
% %UPRRSSO protects privacy in SSO through ID transformations and our prototype does NOT use either iframe or third-party cookies.

