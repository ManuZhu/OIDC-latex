\section{Threat Model and Assumption}
\label{sec:assumptionandthreatmodel}
UPPRESS follows the same service mode as traditional SSO systems (e.g., SAML and OIDC),
    and it consists of an IdP, a number of RPs and users.
The IdP provides user authentication services for all RPs.
In this section,
    we describe the threat model and assumptions of these entities in UPPRESSO.

\subsection{Threat Model}
The IdP is assumed to be curious-but-honest,
 while some malicious users and RPs could be completely compromised by adversaries. % or even collude with each other.
Malicious users and RPs behave arbitrarily and may collude with each other,
     attempting to break the guarantees of security and privacy for other correct users.
%While, the IdP will follow the protocol correctly, and is only curious about the user's privacy.
%The details are as follows.

\vspace{1mm}\noindent \textbf{Curious-but-honest IdP.}
The IdP strictly follows its specification, but is curious about the user privacy, especially the login activities at different RPs.
The IdP is well-protected and never leak any sensitive information.
For example, the private key to sign identity proofs and RP certificates (see Section~\ref{implementations} for details)
     is held by the IdP always,
 so adversaries cannot forge an identity proof or RP certificate.
The honest IdP follows the designed protocols to process the requests from users and RPs,
    and never colludes with any others (e.g., malicious RPs or users).
For example, IdP ensures the uniqueness of $ID_{RP}$ and $ID_{U}$ when an RP or a user registers,
    and computes the pseudo-identifier as the UPPRESSO protocol specifies.

However, the curious IdP attempts to break the user's privacy without violating the protocol.
For example, the curious IdP may store all messages received and sent,
    and tries to conduct attacks of login tracing or identity linkage
        by analyzing the relationship among $ID_U$, $ID_{RP}$, $PID_{U}$ and $PID_{RP}$.

%User's goal: 向IdP发送identity proof，使IdP认为自己是另一个victim
%方式：1）已经拥有有效的identity proof，希望与IdP协商出相同的PID_RP；2）通过篡改或者伪造identity proof来实现攻击
\vspace{1mm}\noindent \textbf{Malicious users.}
The adversaries could compromise a set of users, by stealing the users' credentials~\cite{WangZWYH16, SunCL12}
 or registering sybil users at the IdP and RPs directly.
These malicious users
     aim to break the security of UPPRESSO.
That is, they  attempt to impersonate  an uncompromised user at some correct RP,
 or trick a victim user to log into an correct RP under the identity of a compromised user.
%To achieve this, they could behave arbitrarily~\cite{WangCW12, SomorovskyMSKJ12}.
For example, the malicious users may %forge the identity proof,
 modify, inject, drop and replay any messages,
  and deviate arbitrarily from the specification when processing $ID_{RP}$, $PID_{RP}$ and identity proofs.

% the forwarding messages (requests of identity proof, identity proof,  RP registration request and result, and etc.),
%  and provide incorrect values for negotiating $PID_{RP}$ (detailed in Section~\ref{implementations}).

%RP's goal:1)获得目前登录用户在其他RP可用的identity proof；2）collusive RP 关联用户
\vspace{1mm}\noindent \textbf{Malicious RPs.}
The adversary could compromised a set of RPs,
 by registering an RP at the IdP or exploiting software vulneraries to intrude RPs.
These malicious RPs aim to break the security and privacy of correct users, and behave arbitrarily.
For example,
    malicious RPs attempt to obtain an identity proof valid for another RP, to allow some user to log into this target RP:
    a malicious RP manipulates $PID_{RP}$ when a user is logging in,
        to receive an identity proof that will be accepted by the target RP verifying $PID_{RP}$ but not $ID_{RP}$.
% or constructing an incorrect request to trigger the IdP issuing an identity proof binding with other RP.
Or, the malicious RPs may collude to perform RP-based identity linkage to break user privacy.
For example, the RPs may attempt to derive $ID_U$ from $PID_U$ and $Account$ by manipulating $PID_{RP}$ to the IdP,
        to link the user's multiple logins at different RPs. %by providing correlated values (e.g., $PID_{RP}$) to the IdP.

\vspace{1mm}\noindent \textbf{Collusive users and RPs.} %In particular,
Malicious users and RPs may collude and behave arbitrarily,
 attempting to break the guarantees of security and privacy.
For example,
    collusive malicious users and RPs may conduct impersonation or identity injection attacks,
        by manipulating $PID_U$ and $PID_{RP}$ in an identity proof.
%Or,
%    they collude to

%the adversary may first act as a malicious RP, and make an incorrect identity proof generated for the visiting user,
%  then act a malicious user, and use this identity proof to impersonate this victim user at another RP.
%The adversary could also first act as a user to login a correct RP and obtain an identity proof,
% then act a malicious RP to perform the identity injection attack, by injecting this identity proof to the session between the victim user and the correct RP with other web attacks (e.g., CSRF).


\subsection{Assumption}
We assume that the user agent deployed at an honest user is correctly implemented,
    and transmit messages to the destination correctly.
TLS is also correctly implemented at the IdP, (correct) RPs and users,
        which ensures confidentiality and integrity of the communications among correct entities.

The cryptographic algorithms (such as RSA and SHA-256)
 and building blocks (such as random number generators and the discrete logarithm problem) used in UPPRESSO,
    are assumed to be secure and correctly implemented.

%We also assume a secure random number generator is adopted in UPPRESSO to provide the unpredictable random numbers;
%and the adopted cryptographic algorithms, including the RSA and SHA-256, are secure and implemented correctly.
%Therefore,  no one without private key can forge the signature, and the adversary fails to infer the private key during the computation.
%Moreover, we also assume the security of the discrete logarithm problem is ensured.

UPPRESSO considers the RP-based identity linkage based on the user identifiers at RPs,
    so other RP-based identity linkage based on the distinctive user attributes at RPs (e.g., telephone number, address and driver license) are out of the scope of this paper.
We prevent the IdP-based login tracing based on the SSO protocols,
    and we do not consider other network attacks (e.g., the network traffic analysis to associate a user's logins at different RPs).

%The collusive RPs may attempt to link a user  based on the identifying attributes, such as the telephone number and credit number.
%Here, we assume that the users refuse to provide these attributes to the RPs, and the correct RPs never collect these attributes as required by privacy laws (e.g., GDPR~\cite{wachter2017counterfactual}).
%Moreover, the global network traffic analysis may be adopted to correlate the user's logins at different RPs.
%  However, UPPRESSO may integrate existing defenses to prevent this attack.

