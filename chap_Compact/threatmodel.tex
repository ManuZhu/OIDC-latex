
\section{The Designs of UPPRESSO}
\label{sec:UPPRESSO}

This section presents the threat model and assumptions.
We then introduce identity-transformation algorithms satisfying the requirements
    and the UPPRESSO protocols.


\subsection{Threat Model}
The system consists of an honest-but-curious IdP, a number of RPs and users which could be compromised. % or even collude with each other.
This model is consistent with the widely-used SSO services \cite{OpenIDConnect,rfc6749,SAML,SAMLIdentifier,NIST2017draft}.

%\vspace{0.5mm}
\noindent \textbf{Honest-but-curious IdP.}
An IdP follows the protocols strictly, while being interested in learning user profiles.
For example, it might store all received messages
 to infer the relationship among $ID_U$, $ID_{RP}$, $PID_{U}$, and $PID_{RP}$.
 % to track a user's login activities.
It never actively violates the protocols,
so a script downloaded from the IdP also strictly follows the protocols (see Section \ref{sec:web-design} about the specific designs
    for web applications).
The IdP maintains the private key well for signing identity tokens and RP certificates, %(see Section \ref{implementations} for details)
so adversaries cannot forge such tokens or certificates.

%\vspace{0.5mm}
\noindent \textbf{Malicious Users.}
Adversaries could control a set of users,
 by stealing users' credentials or registering Sybil users in the system.
They want to impersonate a victim user at honest RPs,
 or allure an honest user to login to an honest RP under another user's account.
%To achieve this, they could behave arbitrarily \cite{WangCW12, SomorovskyMSKJ12}.
A malicious user might
    modify, insert, drop or replay messages, or behave arbitrarily in login flows.

\noindent \textbf{Malicious RPs.}
Adversaries could control a set of RPs, by registering at the IdP as an RP
     or exploiting vulnerabilities to compromise some RPs.
Malicious RPs might behave arbitrarily to break the security and privacy guarantees;
%they may attempt to obtain a valid identity token for another RP, to allow some user to log into this target RP:
e.g., manipulate $PID_{RP}$ in a login instance,
    attempting to (\emph{a}) allure honest users to return an identity token that might be accepted by some honest RP,
or (\emph{b}) influence the generation of $PID_U$ to
    analyze the relationship between $ID_U$ and $PID_U$.


%\vspace{0.5mm}
\noindent \textbf{Colluding Users and RPs.}
Malicious users and RPs might collude,
 attempting to break the security and privacy guarantees for honest users.
For example, a malicious RP might collude with malicious users to steal another user's identity token,
    to impersonate the victim user at some honest RP.

Finally, we do \emph{not} consider the collusion of the IdP and RPs.
    If the IdP could collude with some RPs,
        a user will finish login flows completely with colluding entities
        and then in principle we need a long-term user secret to protect (or transform) the permanent accounts across these RPs.
This secret is held \emph{only} by the user;
    otherwise, the colluding IdP and RPs could always link these accounts.
%Note that we aim to design a solution for SSO users without any non-ephemeral secret verified by the RPs.
However, such accounts derived from the user secret have to be updated,
    if it is lost or leaked
    (see discussions in Section \ref{sec:discussion}).

\subsection{Assumptions}
HTTPS is adopted to secure the communications between honest entities,
 and the adopted cryptographic primitives are secure.
The software stack of an honest entity is correctly implemented,
     to transmit messages to receivers as expected.

UPPRESSO is designed for users who care about privacy,
so a user never authorizes the IdP to enclose any \emph{distinctive} attributes in identity tokens,
 such as telephone number, Email address, etc.
         %driver license,
A user does not configure  distinctive attributes at any RP, either.
So the privacy leakage due to re-identification by distinctive attributes across RPs,
    is out of our scope.

We focus on the privacy threats introduced by SSO protocols.
The traffic analysis tracking a user's activities from network packets
    and the active account linkage through malicious web pages,
        exist in SSO scenarios but also in other web systems.
If a user visits multiple RPs concurrently from one browser,
        a malicious RP might actively redirect his account to another RP server by crafted web pages.
Such attacks are prevented by other defenses \cite{FedCM},
    not considered in our work.

