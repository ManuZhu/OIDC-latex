\section{Threat Model and Assumption}
\label{sec:assumptionandthreatmodel}
UPPRESS follows the same service mode as traditional SSO systems (e.g., SAML and OIDC), 
    and it consists of an IdP, a number of RPs and users.
The IdP provides user authentication services for all RPs.
In this section,
    we describe the threat model and assumptions of these components in UPRESSO.

\subsection{Threat Model}
The IdP is assumed to be curious-but-honest,
 while some users and some RPs could be completely controlled by adversaries. % or even collude with each other.
Malicious users and RPs behave arbitrarily and may collude with each other,
     to break the guarantees of security and privacy for other correct users.
%While, the IdP will follow the protocol correctly, and is only curious about the user's privacy.
%The details are as follows.

\vspace{1mm}\noindent \textbf{Curious-but-honest IdP.}
The IdP strictly follows its specification, but is curious about the user privacy, especially the login activities at different RPs.
The IdP is well-protected and will never leak any sensitive information.
For example, the private key for generating the identity proof and RP certificate (used in Section~\ref{implementations}) will never be leaked,
 therefore the adversary fails to impersonate as the IdP to forge an identity proof or RP certificate.
The honest IdP processes the requests of RP registration and identity proof correctly,
and never colludes with others (e.g., malicious RPs and users).
For example, IdP ensures the uniqueness of $ID_{RP}$ and $PID_{RP}$, and generates the correct RP certificate, $PID_U$ and identity proof.

However, the curious IdP may attempt to break the user's privacy without violating the protocol.
For example, the curious IdP may store and analyze the received messages, and perform the timing attacks, attempting to conduct visit tracing or identity linkage.


%User's goal: 向IdP发送identity proof，使IdP认为自己是另一个victim
%方式：1）已经拥有有效的identity proof，希望与IdP协商出相同的PID_RP；2）通过篡改或者伪造identity proof来实现攻击
\vspace{1mm}\noindent \textbf{Malicious users.}
The adversary could control a set of users, for example through stealing the users' credentials~\cite{WangZWYH16, SunCL12} or registering  at the IdP and RPs directly.
These malicious users
 aim to break the security of the SSO system.
That is, they  attempt to impersonate  an uncontrolled user at the victim RP, and  make  a victim user log in at the correct RP under a controlled identity.
To achieve this, they could behave arbitrarily~\cite{WangCW12, SomorovskyMSKJ12}.
For example, the malicious users may forge the identity proof, modify the forwarding messages (requests of identity proof, identity proof,  RP registration request and result, and etc.), and provide incorrect values for negotiating $PID_{RP}$ (detailed in Section~\ref{implementations}).

%RP's goal:1)获得目前登录用户在其他RP可用的identity proof；2）collusive RP 关联用户
\vspace{1mm}\noindent \textbf{Malicious RPs.}
The adversary could control a set of RPs, by registering an RP at the IdP or exploiting various vulneraries to attack RPs.
These malicious RPs aim to break the security and privacy of the correct users, and could behave arbitrarily.
For example, to break the security, the malicious RPs need to obtain an identity proof valid for other RP, and attempt to achieve this by behaving as follows:
 impersonating other RP at the user by providing the incorrect RP certificate,
 using incorrect values during the negotiation of  $PID_{RP}$ to make  the generated $PID_{RP}$ be same as the one for other RP,
 or constructing an incorrect request to trigger the IdP issuing an identity proof binding with other RP.
Moreover, the malicious RPs may attempt to perform the RP-based identity linkage and break the user's privacy.
To achieve this, the RPs could  behave arbitrarily and collude with each other.
For example, the RPs may attempt to derive the $ID_U$ from $PID_U$ by providing incorrect values to the IdP,
 and the colluded RPs may attempt to link the user's multiple logins, by providing correlated values (e.g., $PID_{RP}$) to the IdP.

\vspace{1mm}\noindent \textbf{Collusive users and RPs.} %In particular,
The malicious users and RPs may collude and behave arbitrarily, attempting to break the security of UPRESSO.
For example,
the adversary may first act as a malicious RP, and make an incorrect identity proof generated for the visiting user,
  then act a malicious user, and use this identity proof to impersonate this victim user at another RP.
The adversary could also first act as a user to login a correct RP and obtain an identity proof,
 then act a malicious RP to perform the identity injection attack, by injecting this identity proof to the session between the victim user and the correct RP with other web attacks (e.g., CSRF).


\subsection{Assumption}
In UPRESSO,
we assume that the user agent deployed at the honest user is correctly implemented,
and will transmit the messages to the correct destination.
The TLS is also correctly implemented at the user agent, IdP and RP, which ensures the confidentiality and integrity of the network traffic between correct entities.

We also assume a secure random number generator is adopted in UPRESSO to provide the unpredictable random numbers;
and the adopted cryptographic algorithms, including the RSA and SHA-256, are secure and implemented correctly.
Therefore,  no one without private key can forge the signature, and the adversary fails to infer the private key during the computation.
Moreover, we also assume the security of the discrete logarithm problem is ensured.

The collusive RPs may attempt to link a user  based on the identifying attributes, such as the telephone number and credit number.
Here, we assume that the users refuse to provide these attributes to the RPs, and the correct RPs never collect these attributes as required by privacy laws (e.g., GDPR~\cite{wachter2017counterfactual}).
Moreover, the global network traffic analysis may be adopted to correlate the user's logins at different RPs.
  However, UPRESSO may integrate existing defenses to prevent this attack.

