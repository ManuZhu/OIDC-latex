\documentclass[letterpaper,onecolumn,10pt]{article}
\begin{document}

\section*{Summary}


\subsection*{Review 1}
\vspace{1mm}\noindent\textbf{Review:}
This paper targets interesting problem of providing SSO that does not allow the IdP or RPs to track users.


\subsection*{Review 2}
\vspace{1mm}\noindent\textbf{Review:}
Simple and neat construction to achieve unlinkable pseudonym that are blindly generated.
A novel system that solves IdP-based login tracing and RP-based identifier linkage problems together.

\subsection*{Review 3}
\vspace{1mm}\noindent\textbf{Review:}
Compatibility with the existing OIDC systems with slight modifications on the IdP and RP ends.

\subsection*{Review 4}
\vspace{1mm}\noindent\textbf{Review:}
The idea of using $ID_{RP}^{ID_U}$ to create domain-specific pseudonyms has been widely used in several pseudonym schemes (anonymous credentials, pseudonym systems, group signatures, DAA ..). And the most common DDH-based OPRF construction uses (almost) the same structure and blinding trick (the pseudonyms are blindly generated by the IdP) as well.

\vspace{1mm}\noindent\textbf{Reply:}
Our contribution in this paper is conceptualizing the
privacy problem in SSO as an identifier transformation problem and explain the reasons that limit existing solutions from fully protecting user privacy against curious IdPs and collusive RPs.
The algorithm provided in this paper may be on of the possible implementation of the identifier transformation.
Moreover, we integrate the algorithm with the OIDC protocol, provide the formal security and privacy analysis and evaluate the prototype system in this paper.

\subsection*{Review 5}
\vspace{1mm}\noindent\textbf{Review:}
\begin{itemize}
\item Abstract and Sec 5.3 claim that UPPRESSO achieves the same security guarantees as OIDC and "UPPRESSO does not introduce any new role nor change the security assumptions for each role" is not true.
 \item Sec 5.3 claims that "we require minimal modifications to the IdP and RP servers", but it is substantially different from OIDC and not compatible with any standard.

\end{itemize}


\vspace{1mm}\noindent\textbf{Reply:}
Now we have removed such claims and rewrote this subsection in section 4.6.

\subsection*{Review 6}
\vspace{1mm}\noindent\textbf{Review:}
In the authorization code flow, the IdP still need to know to the RP it is talking, so whether UPPRESSO can also support the authorization code flow.

\vspace{1mm}\noindent\textbf{Reply:}
The RP's identity is required while exchanging token with authorization code between RP and IdP.
That is, the token request from the RP to IdP is required to carry the RP's ID or the authenticated RP credential issued by IdP.
However, for privady consideration, in UPPRESSO system, the IdP can accept the $PID_{RP}$ instead of the plain $ID_{RP}$.
And the tor may be used to avoid the direct communication between RP and IdP.


\subsection*{Review 7}
\vspace{1mm}\noindent\textbf{Review:}
In particular, discussing the user and RP integration of the new functionality, as the construction now shifts significant parts of the protocol to the user.

\vspace{1mm}\noindent\textbf{Reply:}
The differences between the UPPRESSO and legacy SSO system are not visible to the user.
A user in the UPPRESSO system only needs to visit the RP server with normal browser and press the "Sign In" button to start login flow.
The

\subsection*{Review 8}
\vspace{1mm}\noindent\textbf{Review:}
The analysis of security and privacy meets the following problems.
\begin{itemize}
 \item This paper claims provable security, but there are no proper security models or proofs.
 \item The analysis of privacy is hardly intelligible.
 \item Some sections are hard to follow due to excessive use of notations, and figures are not self-explanatory.
\end{itemize}

\vspace{1mm}\noindent\textbf{Reply:}
Now we have rewrote the analysis of security and privacy in Section 5.

\subsection*{Review 9}
\vspace{1mm}\noindent\textbf{Review:}
Compare the system with EL PASSO: Privacy-preserving, Asynchronous Single Sign-On.

\vspace{1mm}\noindent\textbf{Reply:}
Now we have added the introduction about ELPASSO in section 2.3, and indicated the essential difference between ELPASSO and SSO system.


\subsection*{Review 10}
\vspace{1mm}\noindent\textbf{Review:}
Clarify the contribution on the solutions to each privacy problem compared to the existing work that separately solves these problems.

\vspace{1mm}\noindent\textbf{Reply:}
Now we have provided the detialed description of the dilemma of building privacy-preserving SSO system in section 3.2. And the shortcomes of existing works are introduced in section 2.2 and 2.3.


\newpage
\section*{Original Reviews}

\vspace{1mm}\noindent\textbf{Review 164A}


Review recommendation


2. Reject and resubmit

Reviewer expertise


4. Expert

Overall merit


2. Top 50\% but not top 25\% of submitted papers

Writing quality


3. Adequate

\vspace{1mm}\noindent\textbf{Paper summary}


The paper presents UPPRESSO - a privacy-enhancement for Single Sign-On (SSO), where the user can authenticate to different RPs under RP-specific pseudonyms that the IdP vouches for. These pseudonyms are blindly derived by the IdP as $(ID_{RP})^{ID_U}$ holding the user specific secret $ID_U$. This solution aims at two main privacy properties: 1) the IdP does not learn the RP the user is authenticating to, and 2) pseudonyms for different RP are unlinkable.

\vspace{1mm}\noindent\textbf{Strengths}


- targets interesting problem of providing SSO that does not allow the IdP or RPs to track users

- simple and neat construction to achieve unlinkable pseudonym that are blindly generated

\vspace{1mm}\noindent\textbf{Weaknesses}


- claims provable security, but there are no proper security models or proofs

- contains several unsubstantiated claims regarding usability and security of the proposed solution

- misses related work

\vspace{1mm}\noindent\textbf{Comments for author}

The paper proposes a modification to SSO authentication, such that the user privacy is enhanced in two ways:

1) the IdP is no longer able to trace the users' activities, i.e., learn the RPs the user is authenticating to
2) the user can create unlinkable pseudonyms with each RP

A number of proposals for such privacy-friendly SSO exist already, but most target only one of the two goals. One recent exception is the ElPasso protocol [1], which is not mentioned in the paper.

The idea of the protocol is very simple, and uses the same idea as many existing pseudonym schemes - the user can obtain unique and domain-specific pseudonym that are derived as $ID_{RP} ^ {ID_U}$ where $ID_{RP}$ is a random identifier of the RP and $ID_{RP}$ a user secret. In the case of SSO, both are managed by the IdP - yet the exact pseudonyms in each authentication request are derived blindly by the IdP, such that it cannot learn $ID_{RP}$. This is done by letting the user send $(ID_{RP})^N$ to the IdP, for a random blinding value N which is known to both the user the RP.

The idea of using $ID_{RP}^{ID_U}$ to create domain-specific pseudonyms has been widely used in several pseudonym schemes (anonymous credentials, pseudonym systems, group signatures, DAA ..) but also in the context of SSO (e.g. [2,1]). The main difference to existing work is that here the pseudonyms are blindly generated by the IdP. Blind here means that the IdP does not learn $ID_{RP}$, i.e., for which RP the pseudonym is generated for. Similar constructions already exist for the related problem of an IdP deriving user and domain-specific pseudonyms, but blinding the user and keeping the domain public, basically just swapping $ID_{RP}$ and $ID_U$ in the scheme. More abstractly, these pseudonyms could be described as OPRF-values (Oblivious PRF), with the IdP holding user-specific PRF keys $ID_U$. The most common DDH-based OPRF construction uses (almost) the same structure and blinding trick as well.

Thus, while the exact application of the DDH idea to this particular type of SSO seems new, the cryptographic novelty is rather limited. This is not an issue, if the paper properly integrates this simple idea into SSO and demonstrate its viability for the considered use case.

Unfortunately, this is not done in a satisfactory manner.

There are already a number of troubling high-level claims on the security of UPPRESSO:

- abstract and Sec 5.3 claim that UPPRESSO achieves the same security guarantees as OIDC and "UPPRESSO does not introduce any new role nor change the security assumptions for each role"

This is not true: in standard OIDC, the user does not have to perform any crucial computations or elaborate certificate checks (beyond standard TLS authentication). However, UPPRESSO crucially relies on the user to verify certificates that the IdP issued to the RP, implicitly comparing it with the RP's TLS certificate to check it is the right RP, and extracting $ID_{RP}$ from it. This is a critical part of the protocol in order to avoid phishing attacks. In standard OIDC, the user relies on the IdP to "authenticate" the RP and bind the id token to it.

- compatibility with OIDC: "we require minimal modifications to the IdP and RP servers"

OIDC outputs standard signatures to the RP, whereas UPPRESSO requires the RP to participate in an interactive protocol to blind and unblind the pseudonym, and check the related signatures. Overall, it is still a relatively lightweight protocol, but it is substantially different from OIDC and not compatible with any standard.

- UPPPRESSO \& authorization code flow: "UPPRESSO can also support the authorization code flow of
OIDC with small modifications" / "can be integrated into OIDC authorization code flow directly"

In the authorization code flow, the IdP server and the RP communicate directly, which renders the authorization code flow unsuitable for any protocol where the IdP is not supposed to learn the RP's identity. The authors suggest to use TOR, but this would not be helpful as the IdP still need to know to whom it is talking.


In particular the first item is troubling, as this reliance on the user to verify and extract $ID_{RP}$ is essential for the security of UPPRESSO, yet is hardly discussed in the construction or security analysis.

The security analysis focuses on the unlinkability of pseudonyms which is expressed in three games that I found hardly intelligible. There is no proper description of the games and the figure is barely readable. From what I could extract, it looks rather static though, i.e., with only limited possibilities for the adversary to interact with honest parties.

The brief privacy analysis is then complemented by a security analysis, that discusses cookies and seems misplaced.
What is missing is a clear description of the desired security and privacy properties and the respective corruption setting and sound justifications and assumptions for the underlying building blocks. In particular, the binding of id tokens to a designated RP now requires much more care and should be analyzed.

There is also a worrisome mismatch with related DDH-based OPRF/pseudonym constructions: All simple DDH-based OPRF constructions require a second layer of hashing and a Gap One-More type of assumption for the security proof -- and a security model that takes the one-more-type of "forgeries" into account. OPRFs or blind pseudonym systems that achieve stronger security require zero-knowledge proofs of well-formed inputs. Neither of these approaches is used by UPPRESSO, but I would expect that a proper security analysis would reveal similar challenges here too.

Apart from the missing security and privacy analysis, there is also a lot of room for improvement regarding the implementation and evaluation. In particular, discussing the user and RP integration of the new functionality, as the construction now shifts significant parts of the protocol to the user.


\vspace{1mm}\noindent\textbf{Related Work}


Pseudonyms \& SSO


[1] EL PASSO: Privacy-preserving, Asynchronous Single Sign-On, 2020
Zhiyi Zhang and
               Michal Kr{\'{o}}l and
               Alberto Sonnino and
               Lixia Zhang and
               Etienne Rivi{\`{e}}re,

[2] UnlimitID: Privacy-Preserving Federated Identity Management using Algebraic MACs, 2016
Marios Isaakidis, Harry Halpin, George Danezis

[3] PseudoID: Enhancing Privacy for Federated Login, 2010
Arkajit Dey and Stephen Weis

Domain-specific (DDH-based) pseudonyms


simply search for the term domain-specific or scope-exclusive pseudonyms




\vspace{1mm}\noindent\textbf{Review 164B}


Review recommendation


2. Reject and resubmit

Reviewer expertise


3. Knowledgeable

Overall merit


3. Top 25\% but not top 10\% of submitted papers

Writing quality


4. Well-written

\vspace{1mm}\noindent\textbf{Paper summary}


In this paper, the authors propose a novel system, called UPPRESSO, to solve two major privacy problems of existing single sign-on (SSO) protocols: identity provider (IdP)-based login tracing and relying party (RP)-based identifier linkage. To solve the former, the system generates pseudo identifiers of RP, by using its registered identifier and a random trapdoor, then redirects and verifies these pseudo identifiers to IdP over the user (unlike standard OIDC design). Similarly, for the latter, they use pseudo user identifier for each RP. They formally prove the system in the semi-honest IdP and malicious RP and client settings. They also implemented the system on top of existing OIDC and substantially evaluate by comparing with the related work.

\vspace{1mm}\noindent\textbf{Strengths}


-	A novel system that solves IdP-based login tracing and RP-based identifier linkage problems together.

-	The protocol is built upon standard and well-studied cryptographic schemes, like SHA-256, RSA-2048 and elliptic curve cryptography.

-	They formally prove the proposed design.

-	Compatibility with the existing OIDC systems with slight modifications on the IdP and RP ends.

\vspace{1mm}\noindent\textbf{Weaknesses}


-	Lack of motivation or justification on the hardness of combining existing solutions that separately solves IdP-based login tracing and RP-based identifier linkage problems.
-	Contributions are not clear for the individual building blocks.
-	Some sections are hard to follow due to excessive use of notations, and figures are not self-explanatory.
-	This may not be the first protocol that solves both privacy issues. An existing work is not compared with.

\vspace{1mm}\noindent\textbf{Comments for author}


This paper is well-motivated and written in general. The authors try to tackle down two major problems of the standard OIDC protocols, by using random trapdoors to translate user and RP identifiers to pseudo identifiers for each login attempts. While doing these, they also guarantee linking long-term identifiers to pseudo identifiers at the allowed party. I find the proposed system elegant and strong under certain assumptions. Overall, this paper could be considered as a Usenix paper. However, it still requires some clarifications and improvements.

Even though the privacy problems, which are being targeted to solve, are separately addressed by the prior art, it seems achieving privacy against both problems is not trivial because of the privacy dilemma behind the existing solutions. However, this point is not well-justified in the paper. Furthermore, it is not clear that if the individual solutions are also novel compared to the existing work.

The authors claim that this is the first system that solves both privacy problems at the same time. However, the following work also claims the same. I would like to see a comparison with this system.

EL PASSO: Privacy-preserving, Asynchronous Single Sign-On.

The paper also is not discussing about the user acceptance of this new design. Okay, it does not require major updates to build the whole system, but still requires modifications on IdP and RP sides. It would be very useful to include such an analysis about how the new protocol affects the usability of existing OIDC. Or, how easy it will be to deploy/convince RPs and IdPs for the new design.

Some clarification on the text could improve the readability. For instance, it is not clear that PIDrp= NuIDrp at page 7, bullet 2.3, is a regular multiplication or an operation on elliptic curve cryptography.

\vspace{1mm}\noindent\textbf{Requested Changes}


-	Compare the system with EL PASSO: Privacy-preserving, Asynchronous Single Sign-On.

-	Clarify the contribution on the solutions to each privacy problem compared to the existing work that separately solves these problems.

-	Clarify the text to avoid misunderstanding on certain algorithms, e.g., PIDrp computation at step 2.3 at page 7.

\vspace{1mm}\noindent\textbf{Questions for authors' response}


-	How hard is combining existing solutions, SPRESSO and PPID, to prevent both privacy problems? Or are these two protocols not compatible with each other?

-	What is the user acceptance and usability of your system compared to existing OIDC protocols?
\end{document}
