\documentclass[letterpaper,onecolumn,10pt]{article}
\begin{document}

\section*{Reviews from the Submission to USENIX Security 2021 and Our Improvements}

This manuscript was submitted to USENIX Security 2021 under the title ``UPPRESSO: An Unlinkable Privacy-PREserving Single Sign-On System'',
     and the decision was Reject and Resubmit.

The following are the weaknesses extracted from the reviews.
We have improved the designs and implementations greatly, to solve these weaknesses.

\subsection*{Review 1}
\noindent\textbf{1. Missing related works}
A number of proposals for such privacy-friendly SSO exist already, but most target only one of the two goals.
One recent exception is the ElPasso protocol [1], which is not mentioned in the paper.
The idea of using $ID_{RP}^{ID_U}$ to create domain-specific pseudonyms has been widely used in several pseudonym schemes (anonymous credentials, pseudonym systems, group signatures, DAA ..) but also in the context of SSO (e.g. [2,1]).

[1] EL PASSO: Efficient and lightweight privacy-preserving single sign on. 2021.

[2] UnlimitID: Privacy-preserving federated identity management using algebraic MACs. 2016.

[3] PseudoID: Enhancing privacy for federated login. 2010.


\noindent\textbf{2. Prototype implementation and evaluation}
Thus, while the exact application of the DDH idea to this particular type of SSO seems new, the cryptographic novelty is rather limited.
This is not an issue, if the paper properly integrates this simple idea into SSO and demonstrate its viability for the considered use case.
Unfortunately, this is not done in a satisfactory manner.

There is also a lot of room for improvement regarding the implementation and evaluation. In particular, discussing the user and RP integration of the new functionality, as the construction now shifts significant parts of the protocol to the user.

\noindent\textbf{3. Proofs of security and privacy}
- claims provable security, but there are no proper security models or proofs
There are already a number of troubling high-level claims on the security of UPPRESSO:

- abstract and Sec 5.3 claim that UPPRESSO achieves the same security guarantees as OIDC and "UPPRESSO does not introduce any new role nor change the security assumptions for each role"
This is not true: in standard OIDC, the user does not have to perform any crucial computations or elaborate certificate checks (beyond standard TLS authentication). However, UPPRESSO crucially relies on the user to verify certificates that the IdP issued to the RP, implicitly comparing it with the RP's TLS certificate to check it is the right RP, and extracting $ID_{RP}$ from it. This is a critical part of the protocol in order to avoid phishing attacks. In standard OIDC, the user relies on the IdP to "authenticate" the RP and bind the id token to it.


The security analysis focuses on the unlinkability of pseudonyms which is expressed in three games that I found hardly intelligible. There is no proper description of the games and the figure is barely readable. From what I could extract, it looks rather static though, i.e., with only limited possibilities for the adversary to interact with honest parties.

The brief privacy analysis is then complemented by a security analysis, that discusses cookies and seems misplaced.
What is missing is a clear description of the desired security and privacy properties and the respective corruption setting and sound justifications and assumptions for the underlying building blocks. In particular, the binding of id tokens to a designated RP now requires much more care and should be analyzed.

There is also a worrisome mismatch with related DDH-based OPRF/pseudonym constructions: All simple DDH-based OPRF constructions require a second layer of hashing and a Gap One-More type of assumption for the security proof -- and a security model that takes the one-more-type of "forgeries" into account. OPRFs or blind pseudonym systems that achieve stronger security require zero-knowledge proofs of well-formed inputs. Neither of these approaches is used by UPPRESSO, but I would expect that a proper security analysis would reveal similar challenges here too.

\noindent\textbf{2. Usability}

- contains several unsubstantiated claims regarding usability of the proposed solution
- compatibility with OIDC: "we require minimal modifications to the IdP and RP servers"
OIDC outputs standard signatures to the RP, whereas UPPRESSO requires the RP to participate in an interactive protocol to blind and unblind the pseudonym, and check the related signatures. Overall, it is still a relatively lightweight protocol, but it is substantially different from OIDC and not compatible with any standard.

- UPPPRESSO \& authorization code flow: "UPPRESSO can also support the authorization code flow of
OIDC with small modifications" / "can be integrated into OIDC authorization code flow directly"

In the authorization code flow, the IdP server and the RP communicate directly, which renders the authorization code flow unsuitable for any protocol where the IdP is not supposed to learn the RP's identity. The authors suggest to use TOR, but this would not be helpful as the IdP still need to know to whom it is talking.

In particular the first item is troubling, as this reliance on the user to verify and extract $ID_{RP}$ is essential for the security of UPPRESSO, yet is hardly discussed in the construction or security analysis.



\subsection*{Review 1}
\noindent\textbf{1. Motivation}

Lack of motivation or justification on the hardness of combining existing solutions that separately solves IdP-based login tracing and RP-based identifier linkage problems.

\noindent\textbf{1. Contribution}
Contributions are not clear for the individual building blocks.

This may not be the first protocol that solves both privacy issues. An existing work is not compared with.


\noindent\textbf{1. Writing}
Some sections are hard to follow due to excessive use of notations, and figures are not self-explanatory. 



\end{document}
